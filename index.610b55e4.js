function e(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function r(r){return function(r){if(Array.isArray(r))return e(r)}(r)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(r)||function(r,t){if(r){if("string"==typeof r)return e(r,t);var n=Object.prototype.toString.call(r).slice(8,-1);if("Object"===n&&r.constructor&&(n=r.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return e(r,t)}}(r)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var t={LEFT:"ArrowLeft",RIGHT:"ArrowRight",UP:"ArrowUp",DOWN:"ArrowDown"},n=document.querySelector(".message-start"),o=document.querySelector(".message-lose"),c=document.querySelector(".message-win"),a=document.querySelector(".button"),i=document.querySelector(".game-score"),l=[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]],u=0,f=!1,s=l.map(function(e){return r(e)}),d=!0;a.addEventListener("click",k);var m=document.querySelector(".game-field"),v=function(){for(var e=0;e<4;e++)for(var r=m.querySelectorAll(".field-row")[e].querySelectorAll(".field-cell"),t=0;t<4;t++){var n=r[t];n.setAttribute("id","row_".concat(e,"-column_").concat(t)),p(n,l[e][t])}L(),L()},y=function(){return l.some(function(e){return e.some(function(e){return 0===e})})},h=function(){if(y())return!1;for(var e=0;e<4;e++)for(var r=0;r<4;r++)if(l[e][r]===l[e][r+1])return!1;for(var t=0;t<3;t++)for(var n=0;n<4;n++)if(l[t][n]===l[t+1][n])return!1;return!0},g=function(){for(var e=0;e<4;e++)for(var r=0;r<4;r++){var t=document.getElementById("row_".concat(e,"-column_").concat(r));l[e][r]=0,t.innerText="",t.classList.value="",t.classList.add("field-cell")}u=0,i.innerHTML=u},L=function(){if(y()){for(var e=!1,r=.8>Math.random()?2:4;!e;){var t=Math.floor(4*Math.random()),n=Math.floor(4*Math.random());if(0===l[t][n]){l[t][n]=r;var c=document.getElementById("row_".concat(t,"-column_").concat(n));c.innerText="".concat(r),c.classList.add("field-cell--".concat(r)),e=!0}}h()&&(o.classList.remove("hidden"),a.addEventListener("click",function(){o.classList.add("hidden"),g(),k()}))}},p=function(e,r){e.innerText="",e.classList.value="",e.classList.add("field-cell"),r>0&&(e.innerText=r,r<4096?e.classList.add("field-cell--".concat(r)):e.classList.add("field-cell--8192")),2048===r&&(c.classList.remove("hidden"),f=!0)};document.addEventListener("keyup",function(e){if(e.preventDefault(),!f){switch(e.key){case t.LEFT:E();break;case t.RIGHT:S();break;case t.UP:_();break;case t.DOWN:T();break;default:return}document.querySelector(".game-score").innerText=u}});var w=function(e){return e.filter(function(e){return 0!==e})},b=function(e){var t=r(e);t=w(t);for(var n=0;n<t.length-1;n++)t[n]===t[n+1]&&(t[n]*=2,t[n+1]=0,u+=t[n]);for(t=w(t);t.length<4;)t.push(0);return t},A=function(e,t){var n=r(e);"right"===t&&n.reverse(),n=w(n);for(var o=0;o<n.length-1;o++)n[o]===n[o+1]&&(n[o]*=2,n[o+1]=0,u+=n[o]);for(n=w(n);n.length<4;)n.push(0);return"right"===t&&n.reverse(),n},E=function(){for(var e=0;e<4;e++){var r=A(l[e],"left");l[e]=r;for(var t=0;t<4;t++)p(document.getElementById("row_".concat(e,"-column_").concat(t)),l[e][t])}I(s,l)&&L()},S=function(){for(var e=0;e<4;e++){var r=A(l[e],"right");l[e]=r;for(var t=0;t<4;t++)p(document.getElementById("row_".concat(e,"-column_").concat(t)),l[e][t])}I(s,l)&&L()},_=function(){for(var e=0;e<4;e++){var r=[l[0][e],l[1][e],l[2][e],l[3][e]];r=b(r);for(var t=0;t<4;t++)l[t][e]=r[t],p(document.getElementById("row_".concat(t,"-column_").concat(e)),l[t][e])}I(s,l)&&L()},T=function(){for(var e=0;e<4;e++){var r=[l[0][e],l[1][e],l[2][e],l[3][e]];r.reverse(),(r=b(r)).reverse();for(var t=0;t<4;t++)l[t][e]=r[t],p(document.getElementById("row_".concat(t,"-column_").concat(e)),l[t][e])}I(s,l)&&L()},I=function(e,r){for(var t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)if(e[t][n]!==r[t][n])return!0;return!1};function k(){c.classList.add("hidden"),f=!1,g(),v()}a.removeEventListener("click",k),a.addEventListener("click",function(){d?(n.classList.add("hidden"),a.innerText="Restart",a.classList.replace("start","restart"),v(),d=!1):(c.classList.add("hidden"),f=!1,g(),v())});
//# sourceMappingURL=index.610b55e4.js.map
